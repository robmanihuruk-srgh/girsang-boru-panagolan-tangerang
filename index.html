<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèõÔ∏è Girsang Boru Panagolan Tangerang - Management System</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;}
        body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;background:#f8f9fa;color:#333;}
        .header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:20px;text-align:center;box-shadow:0 2px 10px rgba(0,0,0,0.1);position:relative;}
        .header h1{font-size:24px;margin:0;font-weight:600;}
        .header p{font-size:14px;opacity:0.9;margin-top:5px;}
        .close-btn-logout{position:absolute;top:20px;right:20px;cursor:pointer;font-size:24px;background:rgba(255,255,255,0.2);width:40px;height:40px;line-height:40px;border-radius:50%;}
        
        .navbar{background:#fff;padding:15px;box-shadow:0 2px 5px rgba(0,0,0,0.1);position:sticky;top:0;z-index:100;overflow-x:auto;}
        .nav-links{display:flex;justify-content:center;gap:15px;white-space:nowrap;min-width:max-content;}
        .nav-links a{color:#495057;text-decoration:none;font-weight:500;padding:8px 16px;border-radius:20px;transition:all 0.3s;cursor:pointer;font-size:14px;}
        .nav-links a:hover,.nav-links a.active{background:#667eea;color:white;}
        
        .container{max-width:1200px;margin:20px auto;padding:0 15px;}
        
        .stats{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:15px;margin-bottom:20px;}
        .stat-card{background:white;padding:20px;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,0.05);text-align:center;}
        .stat-number{font-size:28px;font-weight:bold;color:#667eea;margin-bottom:5px;}
        .stat-label{color:#666;font-size:12px;text-transform:uppercase;letter-spacing:1px;}
        
        .section{background:white;margin-bottom:30px;border-radius:12px;overflow:hidden;box-shadow:0 4px 6px rgba(0,0,0,0.05);display:none;animation:fadeIn 0.5s;}
        .section.active{display:block;}
        @keyframes fadeIn{from{opacity:0;transform:translateY(10px);}to{opacity:1;transform:translateY(0);}}
        
        .section-header{padding:20px;background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%);color:white;}
        .section-header h2{font-size:18px;margin:0;}
        .section-content{padding:20px;}
        
        .form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:15px;margin-bottom:20px;background:#f8f9fa;padding:20px;border-radius:10px;}
        input,select,textarea{width:100%;padding:10px;border:1px solid #ced4da;border-radius:6px;font-size:14px;}
        input:focus,select:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px rgba(102,126,234,0.1);}
        
        .btn{padding:10px 20px;border:none;border-radius:6px;cursor:pointer;font-size:14px;font-weight:600;transition:0.3s;width:100%;}
        .btn-primary{background:#667eea;color:white;}
        .btn-primary:hover{background:#5a6fd6;}
        .btn-danger{background:#ff6b6b;color:white;}
        
        .table-responsive{overflow-x:auto;}
        table{width:100%;border-collapse:collapse;font-size:14px;}
        th{padding:12px;background:#f1f3f5;color:#495057;text-align:left;font-weight:600;}
        td{padding:12px;border-bottom:1px solid #dee2e6;}
        tr:last-child td{border-bottom:none;}
        
        .status-badge{padding:4px 10px;border-radius:12px;font-size:11px;font-weight:600;text-transform:uppercase;}
        .status-aktif{background:#d4edda;color:#155724;}
        .status-nonaktif{background:#f8d7da;color:#721c24;}
        .money-plus{color:#28a745;font-weight:bold;}
        .money-minus{color:#dc3545;font-weight:bold;}
        
        .login-overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:#f8f9fa;display:flex;align-items:center;justify-content:center;z-index:2000;}
        .login-box{background:white;padding:40px;border-radius:20px;width:90%;max-width:350px;box-shadow:0 10px 25px rgba(0,0,0,0.1);text-align:center;}
        
        @media(max-width:768px){.nav-links{justify-content:flex-start;padding-bottom:5px;}.btn{width:100%;}}
    </style>
</head>
<body>
    <div id="loginOverlay" class="login-overlay">
        <div class="login-box">
            <h2 style="color:#667eea;margin-bottom:10px;">üèõÔ∏è Sistem Manajemen</h2>
            <p style="color:#666;margin-bottom:30px;font-size:14px;">Girsang Boru Panagolan</p>
            <input type="text" id="username" placeholder="Username" style="margin-bottom:10px;">
            <input type="password" id="password" placeholder="Password" style="margin-bottom:20px;">
            <button onclick="login()" class="btn btn-primary">Masuk</button>
            <p style="margin-top:20px;font-size:12px;color:#aaa;">Demo: admin / admin123</p>
        </div>
    </div>

    <div class="header" id="header" style="display:none;">
        <h1>üèõÔ∏è Girsang Boru Panagolan</h1>
        <p>Dashboard Manajemen & Keuangan</p>
        <div class="close-btn-logout" onclick="logout()" title="Keluar">‚èª</div>
    </div>

    <nav class="navbar" id="navbar" style="display:none;">
        <div class="nav-links">
            <a onclick="showSection('dashboard', this)" class="active">üìä Dashboard</a>
            <a onclick="showSection('members', this)">üë• Anggota</a>
            <a onclick="showSection('attendance', this)">üìã Absensi</a>
            <a onclick="showSection('finance', this)">üí∞ Keuangan</a>
        </div>
    </nav>

    <div class="container" id="mainContainer" style="display:none;">
        
        <section class="section active" id="dashboard">
            <div class="section-header"><h2>üìä Ringkasan Data</h2></div>
            <div class="section-content">
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="activeMembers">0</div>
                        <div class="stat-label">Anggota Aktif</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="todayAttendance">0</div>
                        <div class="stat-label">Hadir Hari Ini</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="saldoKas">Rp 0</div>
                        <div class="stat-label">Saldo Kas</div>
                    </div>
                </div>
            </div>
        </section>

        <section class="section" id="members">
            <div class="section-header"><h2>üë• Data Anggota</h2></div>
            <div class="section-content">
                <div class="form-grid">
                    <input type="text" id="nama" placeholder="Nama Lengkap *">
                    <input type="text" id="alamat" placeholder="Alamat *">
                    <input type="text" id="no_hp" placeholder="No. HP">
                    <input type="text" id="jabatan" placeholder="Jabatan">
                    <button onclick="addMember()" class="btn btn-primary">‚ûï Tambah</button>
                </div>
                <div class="table-responsive">
                    <table id="membersTable">
                        <thead><tr><th>Nama</th><th>Alamat/HP</th><th>Jabatan</th><th>Status</th><th>Aksi</th></tr></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section class="section" id="attendance">
            <div class="section-header"><h2>üìã Input Absensi</h2></div>
            <div class="section-content">
                <div class="form-grid">
                    <select id="member_id_att"></select>
                    <input type="date" id="tanggal_att">
                    <select id="status_hadir">
                        <option value="hadir">Hadir</option>
                        <option value="sakit">Sakit</option>
                        <option value="izin">Izin</option>
                    </select>
                    <button onclick="addAttendance()" class="btn btn-primary">‚úÖ Simpan</button>
                </div>
                <h3 style="margin:20px 0 10px;font-size:16px;">Riwayat Absensi</h3>
                <div class="table-responsive">
                    <table id="attendanceTable">
                        <thead><tr><th>Tanggal</th><th>Nama</th><th>Status</th><th>Waktu</th></tr></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section class="section" id="finance">
            <div class="section-header"><h2>üí∞ Kas & Keuangan</h2></div>
            <div class="section-content">
                <div class="form-grid">
                    <input type="text" id="deskripsi_fin" placeholder="Keterangan Transaksi *">
                    <input type="number" id="jumlah_fin" placeholder="Nominal (Rp) *">
                    <select id="jenis_fin">
                        <option value="pemasukan">‚ûï Pemasukan</option>
                        <option value="pengeluaran">‚ûñ Pengeluaran</option>
                    </select>
                    <input type="date" id="tanggal_fin">
                    <button onclick="addFinance()" class="btn btn-primary">üí∏ Simpan Transaksi</button>
                </div>
                <h3 style="margin:20px 0 10px;font-size:16px;">Riwayat Transaksi</h3>
                <div class="table-responsive">
                    <table id="financeTable">
                        <thead><tr><th>Tanggal</th><th>Keterangan</th><th>Jenis</th><th>Jumlah</th></tr></thead>
                        <tbody></tbody>
                    </table>
                </div>
            </div>
        </section>

    </div>

    <script>
        // --- DATA MANAGEMENT ---
        let members = JSON.parse(localStorage.getItem('gbp_members')) || [];
        let attendance = JSON.parse(localStorage.getItem('gbp_attendance')) || [];
        let finance = JSON.parse(localStorage.getItem('gbp_finance')) || [];

        // --- AUTH SYSTEM ---
        function login() {
            const u = document.getElementById('username').value;
            const p = document.getElementById('password').value;
            if(u === 'admin' && p === 'admin123') {
                localStorage.setItem('gbp_logged', 'true');
                initApp();
            } else {
                alert('Login Gagal!');
            }
        }

        function logout() {
            if(confirm('Keluar dari sistem?')) {
                localStorage.removeItem('gbp_logged');
                location.reload();
            }
        }

        function initApp() {
            document.getElementById('loginOverlay').style.display = 'none';
            document.getElementById('header').style.display = 'block';
            document.getElementById('navbar').style.display = 'block';
            document.getElementById('mainContainer').style.display = 'block';
            
            // Set Default Date
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('tanggal_att').value = today;
            document.getElementById('tanggal_fin').value = today;

            loadAllData();
        }

        // --- NAVIGATION ---
        function showSection(id, element) {
            document.querySelectorAll('.section').forEach(el => el.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            
            if(element) {
                document.querySelectorAll('.nav-links a').forEach(el => el.classList.remove('active'));
                element.classList.add('active');
            }
            loadAllData(); // Refresh data on switch
        }

        // --- LOAD DATA (RENDER) ---
        function loadAllData() {
            loadMembersTable();
            loadAttendanceTable();
            loadFinanceTable();
            loadDashboard();
            loadDropdowns();
        }

        function loadDashboard() {
            document.getElementById('activeMembers').innerText = members.filter(m => m.status === 'aktif').length;
            
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('todayAttendance').innerText = attendance.filter(a => a.tanggal === today && a.status === 'hadir').length;
            
            const total = finance.reduce((acc, curr) => {
                return curr.jenis === 'pemasukan' ? acc + Number(curr.jumlah) : acc - Number(curr.jumlah);
            }, 0);
            document.getElementById('saldoKas').innerText = 'Rp ' + total.toLocaleString('id-ID');
        }

        function loadMembersTable() {
            const tbody = document.querySelector('#membersTable tbody');
            tbody.innerHTML = '';
            members.forEach(m => {
                let row = `<tr>
                    <td><strong>${m.nama}</strong></td>
                    <td>${m.alamat}<br><small style="color:#666">${m.hp}</small></td>
                    <td>${m.jabatan}</td>
                    <td><span class="status-badge ${m.status === 'aktif' ? 'status-aktif' : 'status-nonaktif'}">${m.status}</span></td>
                    <td><button onclick="toggleMember(${m.id})" class="btn-danger" style="padding:5px 10px;font-size:10px;width:auto;">Ubah Status</button></td>
                </tr>`;
                tbody.innerHTML += row;
            });
        }

        function loadAttendanceTable() {
            const tbody = document.querySelector('#attendanceTable tbody');
            tbody.innerHTML = '';
            // Sort by latest date
            const sorted = [...attendance].sort((a,b) => new Date(b.tanggal) - new Date(a.tanggal));
            
            sorted.slice(0, 50).forEach(a => { // Show last 50
                const member = members.find(m => m.id == a.member_id);
                const name = member ? member.nama : 'Anggota Terhapus';
                let row = `<tr>
                    <td>${a.tanggal}</td>
                    <td>${name}</td>
                    <td>${a.status.toUpperCase()}</td>
                    <td>${a.waktu}</td>
                </tr>`;
                tbody.innerHTML += row;
            });
        }

        function loadFinanceTable() {
            const tbody = document.querySelector('#financeTable tbody');
            tbody.innerHTML = '';
            const sorted = [...finance].sort((a,b) => new Date(b.tanggal) - new Date(a.tanggal));

            sorted.slice(0, 50).forEach(f => {
                const colorClass = f.jenis === 'pemasukan' ? 'money-plus' : 'money-minus';
                const sign = f.jenis === 'pemasukan' ? '+' : '-';
                let row = `<tr>
                    <td>${f.tanggal}</td>
                    <td>${f.deskripsi}</td>
                    <td>${f.jenis.toUpperCase()}</td>
                    <td class="${colorClass}">${sign} Rp ${Number(f.jumlah).toLocaleString('id-ID')}</td>
                </tr>`;
                tbody.innerHTML += row;
            });
        }

        function loadDropdowns() {
            const sel = document.getElementById('member_id_att');
            const currentVal = sel.value;
            sel.innerHTML = '<option value="">-- Pilih Anggota --</option>';
            members.filter(m => m.status === 'aktif').forEach(m => {
                sel.innerHTML += `<option value="${m.id}">${m.nama}</option>`;
            });
            sel.value = currentVal;
        }

        // --- ACTIONS ---
        function addMember() {
            const nama = document.getElementById('nama').value;
            const alamat = document.getElementById('alamat').value;
            if(!nama || !alamat) return alert('Nama dan Alamat wajib diisi!');

            members.unshift({
                id: Date.now(),
                nama: nama,
                alamat: alamat,
                hp: document.getElementById('no_hp').value,
                jabatan: document.getElementById('jabatan').value || 'Anggota',
                status: 'aktif'
            });
            saveData();
            document.getElementById('nama').value = '';
            document.getElementById('alamat').value = '';
            document.getElementById('no_hp').value = '';
            alert('Anggota berhasil ditambah');
        }

        function toggleMember(id) {
            const idx = members.findIndex(m => m.id === id);
            if(idx > -1) {
                members[idx].status = members[idx].status === 'aktif' ? 'nonaktif' : 'aktif';
                saveData();
            }
        }

        function addAttendance() {
            const mid = document.getElementById('member_id_att').value;
            const tgl = document.getElementById('tanggal_att').value;
            if(!mid || !tgl) return alert('Pilih anggota dan tanggal!');

            attendance.unshift({
                id: Date.now(),
                member_id: mid,
                tanggal: tgl,
                status: document.getElementById('status_hadir').value,
                waktu: new Date().toLocaleTimeString()
            });
            saveData();
            alert('Absensi tersimpan');
        }

        function addFinance() {
            const desc = document.getElementById('deskripsi_fin').value;
            const jml = document.getElementById('jumlah_fin').value;
            if(!desc || !jml) return alert('Data tidak lengkap!');

            finance.unshift({
                id: Date.now(),
                deskripsi: desc,
                jumlah: jml,
                jenis: document.getElementById('jenis_fin').value,
                tanggal: document.getElementById('tanggal_fin').value
            });
            saveData();
            document.getElementById('deskripsi_fin').value = '';
            document.getElementById('jumlah_fin').value = '';
            alert('Transaksi tersimpan');
        }

        function saveData() {
            localStorage.setItem('gbp_members', JSON.stringify(members));
            localStorage.setItem('gbp_attendance', JSON.stringify(attendance));
            localStorage.setItem('gbp_finance', JSON.stringify(finance));
            loadAllData();
        }

        // Auto Login Check
        if(localStorage.getItem('gbp_logged') === 'true') {
            initApp();
        }
    </script>
</body>
</html>